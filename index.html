<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Weather</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Bootstrap demo</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous" />
    <link rel="stylesheet" href="src/styles.css" />
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <style>
        h1 {
            color: #1a64d6;
            font-size: 68px;
            font-weight: 900px;
        }

        h3 {
            font-weight: lighter;
            font-size: 24px;
        }

        li {
            font-weight: 400;
            list-style-type: none;
        }

        .reset-btn {
            border: 1px solid #4d4d4d;
            border-radius: 2px;
            padding-bottom: 2px;
            padding-left: 6px;
            padding-right: 6px;
        }

        .wrap-curr-info {
            background-image: url('https://www.esciencecenter.nl/wp-content/uploads/2020/02/Clouds_Unsplash-1024x580.jpg');
            width: 800px;
            margin: 0 auto;
            margin-top: 30px;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 10px 5px 10px 5px rgba(0, 0, 0, 0.2);
        }

        .curr-icon {
            text-align: left;
            font-size: 70px;
        }

        .curr-desc {
            text-align: left;
            padding-left: 15px;
            font-size: 24px;
        }

        .curr-temp {
            font-size: 44px;
            font-weight: 600;
        }

        .curr-temp-unit {
            position: relative;
            top: -20px;
        }


        .curr-extremes {
            font-weight: 500;
            position: relative;
            bottom: -25px;
        }

        .card {
            width: 800px;
            margin: 0 auto;
            margin-top: 5px;
            padding: 20px 0;
            border-radius: 10px;
            box-shadow: 10px 5px 10px 5px rgba(0, 0, 0, 0.2);
        }

        .card-body {
            text-align: center;
            margin: 0;
            padding: 10px 0;
        }

        .card-day {
            font-size: 20px;
            text-align: center;
        }

        .card-descr {
            text-align: center;
            font-family: 'Times New Roman', Times, serif;
        }

        .card-icon {
            text-align: center;
            font-size: 30px;
        }

        .card-temp {
            text-align: center;
            font-family: 'Times New Roman', Times, serif;
        }

        .footer {
            text-align: center;
            font-size: 12px;
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="wrap-curr-info">
            <div class="row justify-content-between">
                <div class="col-6">
                    <h1 id="city">Porto</h1>
                    <h3 id="date">Monday, 8 August</h3>
                    <h3 id="hour">19:30</h3>
                </div>
                <div class="col-6">
                    <form id="search-form">

                        <input type="text" placeholder="Insert city" id="search-input" />
                        <input type="submit" value="Search" />
                        <button class="reset-btn" id="reset-btn">Current</button>

                    </form>
                </div>
                <p>

                    <!-- Force next columns to break to new line -->
                <div class="w-100"></div>
                <div class="curr-info">
                    <div class="row justify-content-start">
                        <div class="col-3">

                            <p class="curr-icon">☀</p>

                            <p class="curr-desc" id="curr-description">
                                Sunny
                            </p>
                        </div>

                        <div class="col-2">
                            <h4>Current</h4>
                            <span class="curr-temp" id="current-temperature">
                                23
                            </span>

                            <span class="curr-temp-unit">
                                <a href="#" id="celsius-link">⁰C</a> |
                                <a href="#" id="fahrenheit-link">⁰F</a>
                            </span>
                            <div class="curr-extremes">
                                </di>
                                16⁰C/24⁰C
                            </div>
                        </div>

                        <div class="col-3">
                            <ul>
                                <li>Humidity: <span id="humidity"></span></span> %</li>
                                <li>Wind: <span id="wind"></span> km/h</li>
                            </ul>
                        </div>
                    </div>
                </div>
                </p>
            </div>
        </div>


        <br>
        <!-- Force next columns to break to new line -->
        <div class="w-100"></div>

        <div class="card">
            <div class="row justify-content-center">
                <div class="col-2">
                    <div class="card-body">
                        <h4 class="card-day">Tuesday
                    </div>
                    <p class="card-icon">☀</p>
                    <p class="card-descr">
                        Sunny
                    </p>
                    <p class="card-temp">
                        17⁰C/24⁰C
                    </p>
                </div>


                <div class="col-2">
                    <div class="card-body">
                        <h4 class="card-day">Wednesday
                    </div>
                    <p class="card-icon">⛅</p>
                    <p class="card-descr">
                        Partly cloudy
                    </p>
                    <p class="card-temp">
                        18⁰C/26⁰C
                    </p>
                </div>


                <div class="col-2">
                    <div class="card-body">
                        <h4 class="card-day">Thursday
                    </div>
                    <p class="card-icon">⛅</p>
                    <p class="card-descr">
                        Partly cloudy
                    </p>
                    <p class="card-temp">
                        18⁰C/23⁰C
                    </p>
                </div>


                <div class="col-2">
                    <div class="card-body">
                        <h4 class="card-day">Friday
                    </div>
                    <p class="card-icon">☀</p>
                    <p class="card-descr">
                        Sunny
                    </p>
                    <p class="card-temp">
                        17⁰C/23⁰C
                    </p>
                </div>


                <div class="col-2">
                    <div class="card-body">
                        <h4 class="card-day">Saturday
                    </div>
                    <p class="card-icon">⛅</p>
                    <p class="card-descr">
                        Partly cloudy
                    </p>
                    <p class="card-temp">
                        17⁰C/22⁰C
                    </p>
                </div>

            </div>
        </div>
        </br>
    </div>
    </div>
    <br>
    <div class="footer">
        <a href="https://github.com/anasilva81/weather-project">Open-source code</a> by Ana Moreira da Silva 2022
    </div>
    </div>
    <script>

        //Get current date

        let todayDate = new Date();

        let days = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"];
        let day = days[todayDate.getDay()];
        let date = todayDate.getDate();
        let months = [
            "January",
            "February",
            "March",
            "April",
            "May",
            "June",
            "July",
            "August",
            "September",
            "October",
            "November",
            "December"
        ];
        let month = months[todayDate.getMonth()];

        let currentDate = document.querySelector("#date");
        currentDate.innerHTML = `${day}, ${date} ${month}`;


        //Get current hour

        let hour = todayDate.getHours();
        if (hour < 10) {
            hours = `0${hours}`;
        }
        let minutes = todayDate.getMinutes();
        if (minutes < 10) {
            minutes = `0${minutes}`;
        }


        let currentHour = document.querySelector("#hour");
        currentHour.innerHTML = `${hour}:${minutes}`;

        //Convert between °C/°F

        function showCelsius(event) {
            event.preventDefault();
            let temperatureElement = document.querySelector("#current-temperature");
            //let temperature = temperatureElement.innerHTML;
            temperatureElement.innerHTML = 23;
        }

        function showFahrenheit(event) {
            event.preventDefault();
            let temperatureElement = document.querySelector("#current-temperature");
            //let temperature = temperatureElement.innerHTML;
            temperatureElement.innerHTML = Math.round((23 * 9) / 5 + 32);
        }

        let celsiusLink = document.querySelector("#celsius-link");
        celsiusLink.addEventListener("click", showCelsius);
        let fahrenheitLink = document.querySelector("#fahrenheit-link");
        fahrenheitLink.addEventListener("click", showFahrenheit);

        //Display city name after submiting form

        function search(event) {
            event.preventDefault();
            let searchField = document.querySelector("#search-input");
            retrieveCityInfo(searchField.value);

            //let h1 = document.querySelector("h1");
            //h1.innerHTML = `${searchField.value}`;
        }

        let searchForm = document.querySelector("#search-form");
        searchForm.addEventListener("submit", search);

        //Search city

        function retrieveCityInfo(city) {
            let units = "metric";
            let apiKey = "39fcb166569b324dfbfd466535557792";
            let apiUrl = `https://api.openweathermap.org/data/2.5/weather?q=${city}&appid=${apiKey}&units=${units}`;
            axios.get(apiUrl).then(displayWeatherInfo);
        }

        //Show current weather info
        function displayWeatherInfo(response) {

            document.querySelector("#city").innerHTML = response.data.name;
            document.querySelector("#current-temperature").innerHTML = Math.round(
                response.data.main.temp
            );
            console.log(response.data.main.temp);
            document.querySelector("#humidity").innerHTML = response.data.main.humidity;
            document.querySelector("#wind").innerHTML = Math.round(
                response.data.wind.speed
            );
            document.querySelector("#curr-description").innerHTML =
                response.data.weather[0].description;
        }

        //Current location button

        function showLocation(position) {
            let lat = position.coords.latitude;
            let lon = position.coords.longitude;
            //console.log(lon);
            //console.log(lat);
            let units = "metric";
            let apiKey = "39fcb166569b324dfbfd466535557792";
            let apiUrl = `https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&units=metric&appid=${apiKey}&units=${units}`;
            axios.get(apiUrl).then(displayWeatherInfo);
        }

        function setCurrentLocation(event) {
            event.preventDefault();
            navigator.geolocation.getCurrentPosition(showLocation);
        }

        let button = document.querySelector("#reset-btn");
        button.addEventListener("click", setCurrentLocation);

    </script>
</body>

</html>